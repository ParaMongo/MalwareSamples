"""
   Copyright (c) 2019 Jack Farley
   This file is part of MalwareSamples
   Usage or distribution of this software/code is subject to the
   terms of the GNU GENERAL PUBLIC LICENSE.
   evasion.py
   ---
"""
import sys


import psutil

def ProcessEvasion(process_name):
    """
    Terminates malware based on running processes
    :param process_name: List of processes that will terminate malware
    :return:
    """


    # Iterate over the all the running process
    for proc in psutil.process_iter():
        try:
            pinfo = proc.as_dict(attrs=['pid', 'name', 'create_time'])
            # Check if process name contains the given name string.
            for process in process_name:
                if process.lower() in pinfo['name'].lower():
                    sys.exit()
        except (psutil.NoSuchProcess, psutil.AccessDenied, psutil.ZombieProcess):
            pass